// Generated by BUCKLESCRIPT VERSION 5.0.6, PLEASE EDIT WITH CARE
'use strict';

var List = require("bs-platform/lib/js/list.js");
var $$Array = require("bs-platform/lib/js/array.js");

function add(a, e) {
  return List.rev_append(/* :: */[
              e,
              /* [] */0
            ], a);
}

function helper(_$staropt$star, _a, size) {
  while(true) {
    var a = _a;
    var $staropt$star = _$staropt$star;
    var chunks = $staropt$star !== undefined ? $staropt$star : /* [] */0;
    if (a) {
      var rest = a[1];
      var head = a[0];
      if (chunks) {
        var chead = chunks[0];
        if (List.length(chead) < size) {
          _a = rest;
          _$staropt$star = add(chunks[1], add(chead, head));
          continue ;
        } else {
          _a = rest;
          _$staropt$star = add(chunks, /* :: */[
                head,
                /* [] */0
              ]);
          continue ;
        }
      } else {
        _a = rest;
        _$staropt$star = /* :: */[
          /* :: */[
            head,
            /* [] */0
          ],
          /* [] */0
        ];
        continue ;
      }
    } else {
      return chunks;
    }
  };
}

function chunk(a, size) {
  var r = helper(undefined, $$Array.to_list(a), size);
  var s = List.rev(List.map(List.rev, r));
  return $$Array.of_list(List.map($$Array.of_list, s));
}

exports.add = add;
exports.helper = helper;
exports.chunk = chunk;
/* No side effect */
